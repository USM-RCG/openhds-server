<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:o="http://openfaces.org/"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:fn="http://java.sun.com/jsp/jstl/functions">

    <h:head>
    </h:head>
    
	<body>
    	<ui:composition template="/templates/default.xhtml">
			<ui:define name="title">OpenHDS - Create Visit</ui:define>
			
		  		<div id="loading-div">
		      		<img src="#{request.contextPath}/resources/images/ajax-loader.gif" alt="loading..."/> #{msg.working}
		  		</div>
		
		  		<ui:param name="crud" value="#{visitCrud}" />
			
	      		<ui:param name="hideTabBar" value="#{flowScope != null}" />
			
          		<ui:define name="listing">
              		<ui:include src="list.xhtml" />
          		</ui:define>
          	<ui:define name="display">
                    
          	<h:outputText value="#{navController.breadcrumbTrail}" />
           
              	<h1><h:outputText value="#{msg.visitCreate}" /></h1>
              	<h:messages id="errors" globalOnly="true" />
              	<h:form id="form">
                  	<h:panelGrid columns="4">
                   
                   	  	<c:if test="#{visitIdGenerator.generated == false}" >
                   	   	  	<h:outputText value="#{msg.visitId}:" />
                   		  	<h:outputText />
                    	  	<h:inputText id="extId" value="#{visitCrud.item.extId}" converter="#{defaultConverter}" />
					      	<h:message for="extId" errorClass="error" errorStyle="color: red" infoStyle="color: green"/>  
                   	  	</c:if>

                      	<h:outputText value="#{msg.fieldWorkerId}:"/>
                      	<h:outputText />
                      	<h:inputText styleClass="collectedBy" autocomplete="off" id="fwId" value="#{visitCrud.item.collectedBy}" converter="#{fieldWorkerExtIdConverter}" />
                      	<h:message for="fwId" errorClass="error" errorStyle="color: red" infoStyle="color: green"/>

                      	<h:outputText value="#{msg.locationId}:"/>
                      	<h:outputText />
                      	<h:inputText styleClass="location" autocomplete="off" id="location" value="#{visitCrud.item.visitLocation}" converter="#{locationExtIdConverter}" />
                      	<h:message for="location" errorClass="error" errorStyle="color: red" infoStyle="color: green"/>

                      	<h:outputText value="#{msg.visitDate} (#{siteProperties.dateFormat})" />
                      	<h:outputText />
                      	<o:dateChooser id="visitDate" value="#{visitCrud.visitDate}" pattern="#{siteProperties.dateFormat}" />
                      	<h:message for="visitDate" errorClass="error" errorStyle="color: red" infoStyle="color: green"/>
					
					  	<h:outputText value="#{msg.visitRoundNumber}:"/>
                      	<h:outputText />
                      	<h:inputText id="roundNum" value="#{visitCrud.item.roundNumber}" styleClass="handleChange" converter="#{defaultConverter}" required="true" />
                      	<h:message for="roundNum" errorClass="error" errorStyle="color: red" infoStyle="color: green"/>
                 	 </h:panelGrid>

                   	<script>
                   		document.getElementById('form:fwId').focus();
 						document.getElementById('form:extId').focus();
 				   	</script>
                   	<br /><br />
                   	<c:choose>
                   		<c:when test="#{flowScope != null}">
                        	<h:commandButton action="createVisit" id="createBtn" value="#{msg.lblCreate}" />
                    	</c:when>
                    	<c:otherwise>
                        	<h:commandButton action="#{visitCrud.create}" value="#{msg.lblCreate}"/>
                    	</c:otherwise>
                   	</c:choose>
            	</h:form>
        	</ui:define>
    	</ui:composition>
	</body>
</html>
